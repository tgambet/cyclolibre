<div class="mapLoader" *ngIf="!stations && !error">
  <span class="icon">
    <i class="fa fa-circle-o-notch fa-spin"></i>
  </span>
  &nbsp;Chargement...
</div>
<div class="mapLoader" *ngIf="error" style="color: red; font-weight: bold">
  {{error}}
</div>

<div class="field has-addons mapButtons" *ngIf="stations">
  <p class="control">
    <a class="button" (click)="typeLooked = 'bike'" [class.is-dark]="typeLooked == 'bike'">
      <span>Vélos</span>
    </a>
  </p>
  <p class="control">
    <a class="button" (click)="typeLooked = 'stand'" [class.is-dark]="typeLooked == 'stand'">
      <span>Emplacements</span>
    </a>
  </p>
</div>

<agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom" [fullscreenControl]=true appMapExtension>
  <agm-marker
      *ngFor="let s of stations; let i = index"
      (markerClick)="clickedStation(s.number, i)"
      [latitude]="s.position.lat"
      [longitude]="s.position.lng"
      [iconUrl]="icon(s)">
    <agm-info-window>
      <div style="text-align: left; color: black;">
        <strong>Station n°{{s.number}}</strong><br>
        {{s.address}}<br>
        <span *ngIf='s.status == "OPEN"'>
          Vélos disponibles: <strong>{{s.available_bikes}}</strong><br>
          Emplacements disponibles: <strong>{{s.available_bike_stands}}</strong><br>
        </span>
        <span *ngIf='s.status == "CLOSED"' style="color: red;">
          <strong>FERMÉE</strong>
        </span>
      </div>
    </agm-info-window>
  </agm-marker>
</agm-map>

<div class="mapLegend" *ngIf="stations && displayLegend">
  <a class="delete" (click)="displayLegend = false"></a>
  <p><span class="l l1"></span> Voie réservée aux vélos</p>
  <p><span class="l l2"></span> Rue avec piste cyclable</p>
  <p><span class="l l3"></span> Rue ou chemin recommandé aux vélos</p>
  <hr>
  <p><img src="/assets/icon-4.svg"> Entre 75 et 100% de vélos disponibles</p>
  <p><img src="/assets/icon-3.svg"> Entre 50 et 75% de vélos disponibles</p>
  <p><img src="/assets/icon-2.svg"> Entre 25 et 50% de vélos disponibles</p>
  <p><img src="/assets/icon-1.svg"> Entre 0 et 25% de vélos disponibles</p>
  <p><img src="/assets/icon-0.svg"> Aucun vélo disponible</p>
</div>
